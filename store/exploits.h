#ifndef W0RMNET_EXPLOITS_H
#define W0RMNET_EXPLOITS_H

#include <stdlib.h>
#include <stdbool.h>
#include "programs.h"

#define EXPLOIT_TYPE_LABEL(x) ExploitTypeLabels[x]

typedef enum {
    ExploitScopeRemote, // If condition matches and packet sent, triggers exploit
    ExploitScopeLocalAuto,  // If condition matches and file is on machine, triggers exploit automatically
    ExploitScopeLocalOpen,  // If condition matches and file is on machine, triggers exploit when file opened
} ExploitScope;

typedef enum {
    ExploitBufferOverflow,
    ExploitLoginBypass,
} ExploitType;

extern const char* ExploitTypeLabels[];

typedef struct {
    const char* id;
    ExploitType exploitType;
    ExploitScope exploitScope;
    const char* programName;
    int programVersion;
    const char* description;
    const char* flavorText; // If remote exploit, the packet message that makes the "Exploit" feel like a real one
} Exploit;

extern Exploit ExploitsList[];

extern int ExploitsListLength;

#endif //W0RMNET_EXPLOITS_H
